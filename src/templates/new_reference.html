{% extends "layout.html" %}

{% block title %}Create a new reference{% endblock %}

{% block body %}

<h2>Create a new reference</h2>

<form action="/new_reference" method="post">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <ul>
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    {% endwith %}

    <div>
        <label for="type">Reference type:</label>
        <select name="type" id="type" required>
            {% for type in all_refs %}
                {% if type == ref_type %}
                <option value="{{ type }}" selected>{{ type }}</option>
                {% else %}
                <option value="{{ type }}">{{ type }}</option>
                {% endif %}
            {% endfor %}
        </select>
    </div>

    <div>
        <label for="name">Reference name:</label>
        <input type="text" name="name" id="name">
    </div>

    <div id="required-fields">
        Required Fields:
        {% for field in required %}
        <label for="{{ field }}">{{ field }}</label>
        <input type="text" name="{{ field }}" id="{{ field }}" required > <br>
        {% endfor %}
    </div>

    <div id="optional-fields">
        Optional Fields:
        {% for field in optional %}
        <label for="{{ field }}">{{ field }}</label>
        <input type="text" name="{{ field }}" id="{{ field }}"> <br>
        {% endfor %}
    </div>

    <input type="submit" value="Submit">
</form>

<script>
const select = document.getElementById("type")
select.addEventListener("change", () => {
    const options = select.children
    const next = options[select.selectedIndex].value
    document.location.replace(`/new_reference?type=${next}`)
}, true)
    
</script>


{% endblock %}